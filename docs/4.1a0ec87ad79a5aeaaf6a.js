(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{ErIi:function(e,t,c){"use strict";c.r(t),c.d(t,"CommentModule",function(){return q});var o=c("ofXK"),n=c("tyNb"),i=c("3Pt+"),s=c("XNiG"),r=c("IzEk"),l=c("1G5W"),m=c("fXoL"),b=c("lJxs"),a=c("7JkF");let d=(()=>{class e{constructor(e){this.socket=e}postComment(e){this.socket.emit("postComment",e)}listenForNewComment(){return this.socket.fromEvent("newComment")}requestHighscoreComments(e){console.log("requestHighscoreComments called"),this.socket.emit("requestHighscoreComments",e)}listenForHighscoreComments(){return this.socket.fromEvent("highscoreComments")}listenForClients(){return this.socket.fromEvent("clients")}listenForErrors(){return this.socket.fromEvent("error")}listenForConnect(){return this.socket.fromEvent("connect").pipe(Object(b.a)(()=>this.socket.ioSocket.id))}listenForDisconnect(){return this.socket.fromEvent("disconnect").pipe(Object(b.a)(()=>this.socket.ioSocket.id))}sendLogin(e){console.log(e.nickname),this.socket.emit("login",e)}disconnect(){console.log("service Disconnect called"),this.socket.disconnect()}connect(){console.log("service Connect called"),this.socket.connect()}}return e.\u0275fac=function(t){return new(t||e)(m.Ub(a.a))},e.\u0275prov=m.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var h=c("DTUA"),g=c("XiUz"),f=c("Wp6s"),u=c("MutI"),v=c("NFeN"),p=c("FKr1"),C=c("f0Cb"),k=c("kmnG"),P=c("qFsG"),Q=c("bTqV");function I(e,t){1&e&&(m.Qb(0,"div"),m.Qb(1,"h3"),m.mc(2,"No selectedHighscore"),m.Pb(),m.Pb())}function x(e,t){if(1&e&&(m.Qb(0,"div"),m.Qb(1,"h3"),m.mc(2),m.Pb(),m.Qb(3,"h3"),m.mc(4),m.Pb(),m.Qb(5,"h3"),m.mc(6),m.Pb(),m.Qb(7,"h3"),m.mc(8),m.Pb(),m.Qb(9,"h3"),m.mc(10),m.Pb(),m.Qb(11,"h3"),m.mc(12),m.Pb(),m.Pb()),2&e){const e=m.ac();m.Bb(2),m.oc("Highscore Id ",e.selectedHighscore.id,""),m.Bb(2),m.oc("Highscore gameId ",e.selectedHighscore.gameId,""),m.Bb(2),m.oc("Highscore score ",e.selectedHighscore.score,""),m.Bb(2),m.oc("Highscore nickname ",e.selectedHighscore.nickname,""),m.Bb(2),m.oc("Highscore time ",e.selectedHighscore.time,""),m.Bb(2),m.oc("Highscore time ",e.selectedHighscore.time,"")}}function F(e,t){if(1&e&&(m.Qb(0,"li"),m.mc(1),m.Pb()),2&e){const e=t.$implicit;m.Bb(1),m.oc(" ",e.nickname," ")}}function H(e,t){if(1&e&&(m.Qb(0,"div"),m.Qb(1,"ul"),m.lc(2,F,2,1,"li",7),m.Pb(),m.Pb()),2&e){const e=t.ngIf;m.Bb(2),m.fc("ngForOf",e)}}function B(e,t){if(1&e&&(m.Qb(0,"h2"),m.mc(1),m.Pb()),2&e){const e=m.ac();m.Bb(1),m.pc("Comments on ",e.selectedHighscore.nickname,"'s score of ",e.selectedHighscore.score,"")}}function S(e,t){if(1&e&&(m.Qb(0,"mat-list-item"),m.Qb(1,"mat-icon",10),m.mc(2,"face"),m.Pb(),m.Qb(3,"div",11),m.mc(4),m.Pb(),m.Qb(5,"div",12),m.mc(6),m.Pb(),m.Mb(7,"mat-divider"),m.Pb()),2&e){const e=t.$implicit;m.Bb(4),m.nc(null==e?null:e.text),m.Bb(2),m.pc("",null==e?null:e.sender," - ",null==e?null:e.posted,"")}}function w(e,t){if(1&e){const e=m.Rb();m.Qb(0,"div"),m.Qb(1,"mat-form-field",13),m.Qb(2,"mat-label"),m.mc(3,"Write Comment"),m.Pb(),m.Mb(4,"input",14),m.Qb(5,"button",15),m.Yb("click",function(){return m.ic(e),m.ac().postComment()}),m.Qb(6,"mat-icon"),m.mc(7,"send"),m.Pb(),m.Pb(),m.Pb(),m.Pb()}if(2&e){const e=m.ac();m.Bb(4),m.fc("formControl",e.commentFC)}}function y(e,t){1&e&&(m.Qb(0,"div",16),m.mc(1," You need to log in to post a comment "),m.Pb())}function L(e,t){if(1&e&&(m.Qb(0,"div",16),m.mc(1),m.Pb()),2&e){const e=t.ngIf;m.Bb(1),m.oc(" ",e," ")}}function N(e,t){if(1&e&&(m.Qb(0,"div",16),m.mc(1),m.Pb()),2&e){const e=m.ac();m.Bb(1),m.oc(" socketId = ",e.socketId," ")}}function O(e,t){if(1&e&&(m.Qb(0,"div",16),m.mc(1),m.Pb()),2&e){const e=m.ac();m.Bb(1),m.oc(" connecting... ",e.userNickname," ")}}const $=[{path:"",component:(()=>{class e{constructor(e,t){this.commentService=e,this.storageService=t,this.commentFC=new i.b(""),this.comments=[],this.unsubscribe$=new s.a,this.loginFC=new i.b(""),this.isLoggedIn=localStorage.length}ngOnInit(){var e,t,c;console.log("Comment Component Initialised"),console.log("Logged in as: ",null===(e=this.storageService.loadClient())||void 0===e?void 0:e.nickname),this.commentService.connect(),this.userNickname=null===(t=this.storageService.loadClient())||void 0===t?void 0:t.nickname,console.log("comment userNickname: ",null===(c=this.storageService.loadClient())||void 0===c?void 0:c.nickname),this.selectedHighscore=history.state.data,console.log("selectedHighscore!! = ",this.selectedHighscore),this.commentService.requestHighscoreComments(this.selectedHighscore),this.commentService.listenForHighscoreComments().pipe(Object(r.a)(1)).subscribe(e=>{console.log(e),console.log(e.length," comments received"),this.comments=e}),this.error$=this.commentService.listenForErrors(),this.clients$=this.commentService.listenForClients(),this.commentService.listenForNewComment().pipe(Object(l.a)(this.unsubscribe$)).subscribe(e=>{console.log("comment received"),this.selectedHighscore&&(console.log("New comment = ",e),console.log("selectedHighscore  = ",this.selectedHighscore),e.highscoreId===this.selectedHighscore.id&&(console.log("equal  = true"),this.comments.push(e)))}),this.commentService.listenForConnect().pipe(Object(l.a)(this.unsubscribe$)).subscribe(e=>{console.log("connect id",e),this.socketId=e}),this.commentService.listenForDisconnect().pipe(Object(l.a)(this.unsubscribe$)).subscribe(e=>{console.log("disconnect id",e),this.socketId=e})}ngOnDestroy(){console.log("CommentModel Component Destroyed"),this.unsubscribe$.next(),this.unsubscribe$.complete(),this.commentService.disconnect()}postComment(){var e,t,c,o;if(console.log("dto nickname: ",null===(e=this.storageService.loadClient())||void 0===e?void 0:e.nickname),(null===(t=this.storageService.loadClient())||void 0===t?void 0:t.nickname)&&this.commentFC.value&&this.selectedHighscore){const e={highscoreId:null===(c=this.selectedHighscore)||void 0===c?void 0:c.id,text:this.commentFC.value,sender:null===(o=this.storageService.loadClient())||void 0===o?void 0:o.nickname};console.log("highscoreId:",e.highscoreId),this.commentService.postComment(e),this.commentFC.patchValue("")}}}return e.\u0275fac=function(t){return new(t||e)(m.Lb(d),m.Lb(h.a))},e.\u0275cmp=m.Fb({type:e,selectors:[["app-comment"]],decls:28,vars:14,consts:[["fxLayout","row","fxFlex",""],["fxLayout","column","fxFlex","30"],["fxFlex",""],[4,"ngIf"],["fxLayout","column","fxFlex","70"],["fxFlex","","fxLayout","column"],["fxFlex","",1,"scrollable-mat-list"],[4,"ngFor","ngForOf"],["class","warn-text-colour","style","font-family: cursive","style","font-size: 14px",4,"ngIf"],["fxFlex","30px",2,"padding-left","30px"],["mat-list-icon",""],["mat-line","",1,"comment-text"],["mat-line","",1,"comment-sender-text",2,"font-size","x-small"],["fxFlex","40",1,"primary-text-colour"],["matInput","","type","text",3,"formControl"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[1,"warn-text-colour",2,"font-size","14px"]],template:function(e,t){1&e&&(m.Qb(0,"div",0),m.Qb(1,"div",1),m.Qb(2,"mat-card",2),m.Qb(3,"mat-card-header"),m.Qb(4,"h4"),m.mc(5,"Comments on"),m.Pb(),m.Pb(),m.Qb(6,"mat-card-content"),m.lc(7,I,3,0,"div",3),m.lc(8,x,13,6,"div",3),m.Qb(9,"h4"),m.mc(10,"Clients"),m.Pb(),m.lc(11,H,3,1,"div",3),m.bc(12,"async"),m.Pb(),m.Pb(),m.Pb(),m.Qb(13,"div",4),m.Qb(14,"mat-card",5),m.Qb(15,"mat-card-header"),m.lc(16,B,2,2,"h2",3),m.Pb(),m.Qb(17,"mat-card-content",5),m.Qb(18,"mat-list",6),m.lc(19,S,8,3,"mat-list-item",7),m.Pb(),m.Pb(),m.Qb(20,"mat-card-actions"),m.lc(21,w,8,1,"div",3),m.lc(22,y,2,0,"div",8),m.Pb(),m.Qb(23,"mat-card-footer",9),m.lc(24,L,2,1,"div",8),m.bc(25,"async"),m.lc(26,N,2,1,"div",8),m.lc(27,O,2,1,"div",8),m.Pb(),m.Pb(),m.Pb(),m.Pb()),2&e&&(m.Bb(7),m.fc("ngIf",!t.selectedHighscore),m.Bb(1),m.fc("ngIf",t.selectedHighscore),m.Bb(3),m.fc("ngIf",m.cc(12,10,t.clients$)),m.Bb(5),m.fc("ngIf",t.selectedHighscore),m.Bb(3),m.fc("ngForOf",t.comments),m.Bb(2),m.fc("ngIf",t.isLoggedIn),m.Bb(1),m.fc("ngIf",!t.isLoggedIn),m.Bb(2),m.fc("ngIf",m.cc(25,12,t.error$)),m.Bb(2),m.fc("ngIf",t.socketId),m.Bb(1),m.fc("ngIf",!t.socketId))},directives:[g.c,g.a,f.a,f.e,f.c,o.k,u.a,o.j,f.b,f.d,u.c,v.a,u.b,p.c,C.a,k.b,k.e,P.a,i.a,i.h,i.c,Q.a,k.f],pipes:[o.b],styles:[".scrollable-mat-list[_ngcontent-%COMP%]{overflow:auto}"]}),e})()}];let E=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.Jb({type:e}),e.\u0275inj=m.Ib({imports:[[n.c.forChild($)],n.c]}),e})();var j=c("PCNd");let q=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=m.Jb({type:e}),e.\u0275inj=m.Ib({imports:[[o.c,E,i.k,j.a]]}),e})()}}]);