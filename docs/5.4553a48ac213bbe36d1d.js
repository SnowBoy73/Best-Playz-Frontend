(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{tADN:function(e,o,t){"use strict";t.r(o),t.d(o,"LeaderboardModule",function(){return L});var c=t("ofXK"),i=t("tyNb"),s=t("3Pt+"),n=t("1G5W"),r=t("IzEk"),a=t("XNiG"),h=t("fXoL"),l=t("7JkF");let d=(()=>{class e{constructor(e,o){this.socket=e,this.router=o}postHighScore(e){console.log("highscore posted = ",e),this.socket.emit("postHighscore",e)}listenForNewHighscore(){return this.socket.fromEvent("newHighscore")}requestGameHighscores(e){console.log("requestGameHighScore called"),this.socket.emit("requestGameHighscores",e)}listenForGameHighscores(){return this.socket.fromEvent("gameHighscores")}sendSelectedHighscore(e){console.log("requestGameHighScore called"),console.log("DTO: ",e.id,e.nickname,e.gameId,e.score,e.date,e.time),this.socket.emit("highscoreDtoFromLeaderboard",e),console.log("Navigate to Comment url"),this.router.navigate(["/comment"],{state:{data:e}})}listenForErrors(){return this.socket.fromEvent("error")}disconnect(){this.socket.disconnect()}connect(){this.socket.connect()}}return e.\u0275fac=function(o){return new(o||e)(h.Ub(l.a),h.Ub(i.a))},e.\u0275prov=h.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var b=t("DTUA"),g=t("XiUz"),m=t("Wp6s"),u=t("MutI"),f=t("NFeN"),v=t("FKr1"),p=t("f0Cb"),k=t("kmnG"),x=t("qFsG"),H=t("bTqV");function F(e,o){if(1&e&&(h.Qb(0,"li"),h.mc(1),h.Pb()),2&e){const e=o.$implicit;h.Bb(1),h.qc(" ",e.score," by ",e.nickname," on ",e.date," ")}}function S(e,o){if(1&e){const e=h.Rb();h.Qb(0,"mat-list-option",12),h.Yb("click",function(){h.ic(e);const o=h.ac(),t=h.hc(16);return o.onNgModelChange(t)}),h.Qb(1,"mat-icon",13),h.mc(2,"face"),h.Pb(),h.Qb(3,"div",14),h.mc(4),h.Pb(),h.Qb(5,"div",15),h.mc(6),h.Pb(),h.Mb(7,"mat-divider"),h.Mb(8,"mat-divider"),h.Pb()}if(2&e){const e=o.$implicit;h.fc("value",e.id),h.Bb(4),h.pc("Score: ",e.score," Time:",e.time,""),h.Bb(2),h.pc("By ",e.nickname," on ",e.date,"")}}function P(e,o){if(1&e){const e=h.Rb();h.Qb(0,"div"),h.Qb(1,"mat-form-field",16),h.Qb(2,"mat-label"),h.mc(3,"Post a mock Highscore (number)"),h.Pb(),h.Mb(4,"input",17),h.Qb(5,"button",18),h.Yb("click",function(){return h.ic(e),h.ac().postHighscore()}),h.Qb(6,"mat-icon"),h.mc(7,"send"),h.Pb(),h.Pb(),h.Pb(),h.Pb()}if(2&e){const e=h.ac();h.Bb(4),h.fc("formControl",e.highscoreFC)}}function Q(e,o){1&e&&(h.Qb(0,"div",19),h.mc(1," You need to log in to post a mock highscore "),h.Pb())}function C(e,o){if(1&e&&(h.Qb(0,"div",19),h.mc(1),h.Pb()),2&e){const e=o.ngIf;h.Bb(1),h.oc(" ",e," ")}}const I=[{path:"",component:(()=>{class e{constructor(e,o){this.leaderboardService=e,this.storageService=o,this.highscoreFC=new s.b(""),this.highscores=[],this.unsubscribe$=new a.a,this.gameId=1,this.isLoggedIn=localStorage.length,this.highscoreSelected="",this.selectedGame="Super Ninja Dude"}ngOnInit(){var e;console.log("Leaderboard Component Initialised"),this.userNickname=null===(e=this.storageService.loadClient())||void 0===e?void 0:e.nickname,this.leaderboardService.requestGameHighscores(this.gameId),this.error$=this.leaderboardService.listenForErrors(),this.leaderboardService.listenForNewHighscore().pipe(Object(n.a)(this.unsubscribe$)).subscribe(e=>{console.log("highscore received"),this.highscores.push(e)}),this.leaderboardService.listenForGameHighscores().pipe(Object(r.a)(1)).subscribe(e=>{console.log(e.length," highscores received"),this.highscores=e}),this.leaderboardService.connect()}postHighscore(){var e,o,t;if(console.log("dto nickname: ",null===(e=this.storageService.loadClient())||void 0===e?void 0:e.nickname),(null===(o=this.storageService.loadClient())||void 0===o?void 0:o.nickname)&&this.highscoreFC.value){const e={nickname:null===(t=this.storageService.loadClient())||void 0===t?void 0:t.nickname,gameId:"c817554b-6a1c-4408-a749-a5650fe92798",score:this.highscoreFC.value,time:123};this.leaderboardService.postHighScore(e),this.highscoreFC.patchValue("")}}ngOnDestroy(){console.log("Leaderboard Component Destroyed"),this.unsubscribe$.next(),this.unsubscribe$.complete(),this.leaderboardService.disconnect()}onNgModelChange(e){if(0!==this.highscoreSelected.length){const e=this.highscoreSelected[0].toString();this.chosenHighscore=this.highscores.find(o=>o.id===e),this.chosenHighscore?(console.log("onNgModelChange = ",this.chosenHighscore.id,this.chosenHighscore.score,this.chosenHighscore.nickname),this.leaderboardService.sendSelectedHighscore({id:this.chosenHighscore.id,nickname:this.chosenHighscore.nickname,gameId:this.chosenHighscore.gameId,score:this.chosenHighscore.score,date:this.chosenHighscore.date,time:this.chosenHighscore.time})):console.log("error - no highscore with that name found")}}}return e.\u0275fac=function(o){return new(o||e)(h.Lb(d),h.Lb(b.a))},e.\u0275cmp=h.Fb({type:e,selectors:[["app-leaderboard"]],decls:24,vars:10,consts:[["fxLayout","row","fxFlex",""],["fxLayout","column","fxFlex","30"],["fxFlex",""],[4,"ngFor","ngForOf"],["fxLayout","column","fxFlex","70"],["fxFlex","","fxLayout","column"],["fxFlex","",1,"scrollList",3,"ngModel","multiple","ngModelChange"],["hiscores",""],[3,"value","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","warn-text-colour","style","font-family: cursive","style","font-size: 14px",4,"ngIf"],["fxFlex","30px",2,"padding-left","30px"],[3,"value","click"],["mat-list-icon",""],["mat-line","",1,"comment-text"],["mat-line","",1,"comment-sender-text",2,"font-size","x-small"],["fxFlex","40",1,"primary-text-colour"],["matInput","","type","text",3,"formControl"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"],[1,"warn-text-colour",2,"font-size","14px"]],template:function(e,o){1&e&&(h.Qb(0,"div",0),h.Qb(1,"div",1),h.Qb(2,"mat-card",2),h.Qb(3,"mat-card-header"),h.Qb(4,"h5"),h.mc(5,"Game details"),h.Pb(),h.Pb(),h.Qb(6,"mat-card-content"),h.Qb(7,"ul"),h.lc(8,F,2,3,"li",3),h.Pb(),h.Pb(),h.Pb(),h.Pb(),h.Qb(9,"div",4),h.Qb(10,"mat-card",5),h.Qb(11,"mat-card-header"),h.Qb(12,"h2"),h.mc(13),h.Pb(),h.Pb(),h.Qb(14,"mat-card-content",5),h.Qb(15,"mat-selection-list",6,7),h.Yb("ngModelChange",function(e){return o.highscoreSelected=e})("ngModelChange",function(e){return o.onNgModelChange(e)}),h.lc(17,S,9,5,"mat-list-option",8),h.Pb(),h.Pb(),h.Qb(18,"mat-card-actions"),h.lc(19,P,8,1,"div",9),h.lc(20,Q,2,0,"div",10),h.Pb(),h.Qb(21,"mat-card-footer",11),h.lc(22,C,2,1,"div",10),h.bc(23,"async"),h.Pb(),h.Pb(),h.Pb(),h.Pb()),2&e&&(h.Bb(8),h.fc("ngForOf",o.highscores),h.Bb(5),h.oc("HighScores for ",o.selectedGame,""),h.Bb(2),h.fc("ngModel",o.highscoreSelected)("multiple",!1),h.Bb(2),h.fc("ngForOf",o.highscores),h.Bb(2),h.fc("ngIf",o.isLoggedIn),h.Bb(1),h.fc("ngIf",!o.isLoggedIn),h.Bb(2),h.fc("ngIf",h.cc(23,8,o.error$)))},directives:[g.c,g.a,m.a,m.e,m.c,c.j,u.f,s.h,s.j,m.b,c.k,m.d,u.e,f.a,u.b,v.c,p.a,k.b,k.e,x.a,s.a,s.c,H.a,k.f],pipes:[c.b],styles:[""]}),e})()}];let y=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=h.Jb({type:e}),e.\u0275inj=h.Ib({imports:[[i.c.forChild(I)],i.c]}),e})();var w=t("PCNd");let L=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=h.Jb({type:e}),e.\u0275inj=h.Ib({imports:[[c.c,y,s.k,w.a]]}),e})()}}]);